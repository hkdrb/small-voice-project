
import random
import json
import datetime
from typing import List, Dict, Any

# --- Sentence Parts Definitions (Proposal Oriented - Synced with generate_test_data.py) ---

INTROS = [
    "改善提案ですが、", "もっと良くするために、", "効率化の提案として、", "個人的なアイデアですが、", 
    "チームの生産性を上げるために、", "以前から考えていたのですが、", "解決策として提案します。", 
    "この課題に対する打ち手として、", "将来的には、", "理想を言えば、", "試してみたいこととして、",
    "議論したい点として、", "解決案ですが、", "思い切って提案しますが、", "ご検討いただきたいのですが、",
    "", "", "", "", "", ""
]

CLOSINGS = [
    "を導入すべきだと思います。", "に変更するのはどうでしょうか。", "を試してみたいです。", 
    "とすることで解決できるはずです。", "の実施を強く推奨します。", "を検討してください。", 
    "で進めるのがベストだと思います。", "のルール化をお願いします。", "への投資が必要だと思います。", 
    "を次回のMTGで議論したいです。", "を標準化しましょう。", "に切り替えるべきです。", 
    "という方向で進めませんか？", "の運用を開始したいです。", "をトライアル導入してはどうでしょう。", 
    "の徹底をお願いしたいです。", "という施策が有効だと思います。", "が良いと思います。", 
    "", "", ""
]

# 1. Project Management
PROJ_SUBJECTS = [
    "朝会の時間については、", "スプリントプランニングの方法は、", "仕様書の更新フローは、", "タスクの粒度に関しては、", "JIRAの運用は、", 
    "意思決定のプロセスについては、", "要件定義の進め方は、", "納期の調整については、", "他部署との連携方法は、", 
    "会議の頻度については、", "ドキュメント管理については、", "リソース配分は、", "バックログの優先順位付けは、", "スプリントレビューは、",
    "Slackの運用ルールは、", "情報の透明性確保については、", "KPTのやり方は、", "心理的安全性向上のため、"
]

PROJ_SOLUTIONS = [
    "15分以内に制限し、延長は禁止する", "非同期コミュニケーションに移行する", "自動化ツールを導入して工数を削減する", 
    "担当者をローテーション制にする", "テンプレート化して品質を統一する", "承認フローを簡略化する", 
    "事前にアジェンダを共有し、準備を義務付ける", "外部の専門家を招いて知見を借りる", "専任のPMをアサインする", 
    "不要な会議を廃止し、Slackでの報告のみにする", "Notionに情報を集約し、検索性を高める", "明確なガイドラインを策定する", 
    "定期的な1on1を実施してフォローする", "すべての履歴をオープンにし、誰でも見れるようにする", "ボトムアップでの提案を推奨する"
]

PROJ_EFFECTS = [
    "ことで、開発時間を確保できます", "ことで、属人化を解消できます", "ことで、意思決定スピードが上がります", 
    "ことで、チームの士気が高まります", "ことで、ミスの発生を防げます", "ことで、無駄な待ち時間をなくせます", 
    "ことで、新人のオンボーディングがスムーズになります", "ことで、本来の業務に集中できます", 
    "ことで、手戻りを最小限に抑えられます", "ことで、心理的負担を軽減できます"
]

# 2. Dev Environment
DEV_SUBJECTS = [
    "ローカル開発環境については、", "CI/CDパイプラインは、", "検証環境のデータ管理は、", "PCのスペックについては、", 
    "VPNの接続問題は、", "社内プロキシの設定は、", "AWSの権限管理は、", "自動テストの運用は、", 
    "ライブラリの更新方針は、", "Copilotの活用については、", "モニターの支給については、", 
    "デプロイフローに関しては、", "ログ監視の仕組みは、", "開発サーバーの増強は、"
]

DEV_SOLUTIONS = [
    "Dockerコンテナを軽量化する", "並列実行数を増やして高速化する", "マスキング済みの本番データを使えるようにする", 
    "M3 Macを一括導入する", "クラウドベースの開発環境(GitHub Codespaces等)に移行する", "より高速なVPNサービスに乗り換える", 
    "IaC(Terraform)ですべて管理する", "E2Eテストを拡充する", 
    "Renovateを導入して自動更新する", "全エンジニアにCopilotライセンスを付与する", "4Kモニターを標準支給する", 
    "ブルーグリーンデプロイを導入する", "Datadog等の専用ツールを導入する"
]

DEV_EFFECTS = [
    "ことで、開発効率が劇的に向上します", "ことで、デプロイ待ち時間を削減できます", "ことで、環境差異によるバグを撲滅できます", 
    "ことで、ストレスなくコーディングできます", "ことで、場所を選ばず働けます", 
    "ことで、セキュリティリスクを低減できます", "ことで、障害時の復旧が早くなります", 
    "ことで、優秀なエンジニアを採用しやすくなります"
]

# 3. Tech Quality
TECH_SUBJECTS = [
    "レガシーコードの解消は、", "APIのパフォーマンス改善は、", "ユニットテストのカバレッジ向上は、", "エラーハンドリングの統一は、", 
    "DBスキーマの見直しは、", "コンポーネント設計の共通化は、", "命名規則の統一は、", 
    "ログ設計については、", "コードレビューの質向上は、", "技術的負債の返済は、", "ドキュメントの整備は、", 
    "マイクロサービス化については、", "例外処理の実装は、", "クエリの最適化は、"
]

TECH_SOLUTIONS = [
    "毎週金曜日をリファクタリングデーにする", "キャッシュ戦略を見直してRedisを導入する", "テストカバレッジ80%をCIの必須条件にする", 
    "共通のエラーハンドリングミドルウェアを実装する", "正規化を徹底し、インデックスを適切に貼る", 
    "Design Systemを構築して再利用する", "Linter/Formatterのルールを厳格化する", 
    "構造化ログ(JSON)を徹底する", "ペアプログラミングを積極的に導入する", 
    "技術的負債返済のためのスプリントを設ける", "Swagger/OpenAPIからコードを自動生成する", 
    "ドメイン駆動設計(DDD)を取り入れる"
]

TECH_EFFECTS = [
    "ことで、保守性が向上します", "ことで、ユーザー体験が改善されます", "ことで、バグの混入を防げます", 
    "ことで、障害調査が容易になります", "ことで、新規メンバーの参画コストが下がります", 
    "ことで、変更に強いシステムになります", "ことで、コードの品質が均一化されます", 
    "ことで、長期的な開発コストを下げられます"
]

# --- Small Voice & Dense Cluster Definitions (Proposal Oriented) ---

SMALL_VOICES = {
    "project": [
        "すべての会議をメタバース上で実施し、アバターでの参加を義務化することを提案します。",
        "意思決定能力を向上させるため、プロジェクトの全決裁権をAIに委ねる試みを開始すべきです。"
    ],
    "product": [
        "徹底したミニマリズムを追求するため、全画面から一切のテキストを排除し、アイコンのみのUIに変更すべきです。",
        "ユーザーの忍耐力を試すため、あえてロード時間にランダムな遅延を発生させる機能を提案します。"
    ],
    "welfare": [
        "開発効率を極限まで高めるため、オフィス内にカプセルホテルを併設し、24時間居住可能な体制を希望します。",
        "場所を選ばない働き方の究極として、宇宙ステーションからのリモートワーク手当を新設してください。"
    ],
    "tech": [
        "テストコードは甘えです。すべての自動テストを廃止し、本番環境でのユーザーの反応のみを信じるべきです。",
        "セキュリティ向上のため、すべての変数名をランダムな32文字の文字列に難読化して管理することを提案します。"
    ],
    "values": [
        "利益追求を一切の悪とし、すべての売上を即座に寄付する純粋な慈善団体への転換を強く提案します。",
        "組織の壁をなくすため、全社員が毎日くじ引きで役職と給与を入れ替える完全平等システムの導入を求めます。"
    ]
}

DENSE_CLUSTERS = {
    "project": [
        {"topic": "会議効率化", "templates": [
            "会議は原則30分以内とし、アジェンダなしの会議は禁止するというルールを提案します。",
            "定例会議を廃止し、Slackでの非同期報告に切り替えることを提案します。",
            "Zoom会議でのカメラON矯正をやめ、画面共有中心の進行にすべきです。", 
            "会議資料は必ず前日までに共有し、会議中は意思決定のみを行う運用にしましょう。",
            "ファシリテーター持ち回り制を導入し、進行スキルを全員で上げるべきです。"
        ]},
        {"topic": "リーダーシップ改善", "templates": [
            "リーダーの方針を明文化し、Wikiで常に確認できるようにしてほしいです。",
            "権限委譲を進めるため、決裁権限規定の見直しを提案します。", 
            "トラブル時のエスカレーションフローをチャート化し、周知徹底すべきです。",
            "マネージャーとメンバーの1on1を隔週で実施し、対話の時間を確保しましょう。",
            "ビジョン合宿を開催し、全員で方向性を再確認する場を作ることを提案します。"
        ]},
        {"topic": "見積もり精度向上", "templates": [
            "見積もりはエンジニア主導で行い、営業はそれに従うフローを確立すべきです。",
            "スケジュールには必ず20%のバッファを含めるルールを提案します。", 
            "仕様変更が発生した場合は、必ず納期の再調整を行う契約にすべきです。",
            "プランニングポーカーを導入し、見積もりの属人化を排除しましょう。",
            "過去の実績データを蓄積し、データに基づいた見積もりを行うツールを導入しませんか。"
        ]},
        {"topic": "情報共有の改善", "templates": [
            "決定事項は必ず全チャンネルでアナウンスするルールにしましょう。",
            "他部署の朝会にランダムで参加し、相互理解を深める施策を提案します。", 
            "口頭での仕様伝達を禁止し、すべてチケットに残す運用を徹底すべきです。",
            "情報の透明性を高めるため、役員会議の議事録も公開してはどうでしょうか。",
            "社内Wikiの構造を整理し、検索性を改善するためのタスクフォースを立ち上げたいです。"
        ]},
        {"topic": "評価制度の刷新", "templates": [
            "定量的な評価基準を策定し、評価の透明性を高めることを提案します。",
            "成果だけでなくプロセスも評価する『バリュー評価』の比重を上げるべきです。",
            "360度評価の結果を本人にフィードバックし、成長の糧にする運用に変えましょう。",
            "評価者研修を実施し、マネージャー間の評価基準のばらつきをなくすべきです。",
            "ピアボーナス制度を導入し、相互評価の文化を作りませんか。"
        ]}
    ],
    "kpt": [
        {"topic": "振り返りプロセスの改善", "templates": [
            "KPTの時間を十分に確保し、形式的にならないよう運用を見直すべきです。",
            "振り返りの内容を次月のアクションプランに確実に反映させる仕組みを作りましょう。",
            "KPTをチーム全体で共有し、他チームの良い取り組みも参考にできるようにしたいです。",
            "振り返りの頻度を見直し、月次だけでなく週次でも軽く実施する運用を提案します。",
            "KPTの結果を可視化し、改善の進捗を追跡できるダッシュボードを作成しませんか。",
            "KPTの前に事前アンケートを実施し、論点を整理してから臨む方式に変更したいです。",
            "ファシリテーターを持ち回り制にし、全員が主体的に参加できる雰囲気を作るべきです。",
            "KPTで出た意見をカテゴリ分けし、優先順位をつけて取り組む仕組みを導入しませんか。",
            "振り返りの質を高めるため、外部のアジャイルコーチを招いて研修を実施すべきです。",
            "KPTの時間を90分に延長し、じっくり議論できる環境を整えたいです。",
            "オンラインツール(Miro等)を活用し、リモートメンバーも参加しやすくすべきです。",
            "KPTの記録をNotionで一元管理し、過去の振り返りも簡単に参照できるようにしましょう。",
            "振り返りの最後に「今月のMVP」を選出し、モチベーション向上につなげたいです。",
            "KPTで出たTryの実行率を測定し、PDCAが回っているか定量的に評価すべきです。",
            "振り返りの冒頭で前回のTryの進捗を必ず確認する運用にしませんか。",
            "KPTをゲーム形式にし、楽しみながら振り返れる工夫を取り入れたいです。",
            "振り返りの場で新しいアイデアを自由に出せる「ブレインストーミングタイム」を設けるべきです。",
            "KPTの内容を経営層にも共有し、現場の声を届ける仕組みを作りましょう。",
            "振り返りで出た課題を「緊急度×重要度」のマトリクスで整理する手法を導入したいです。",
            "KPTの運用ガイドラインを作成し、新メンバーもスムーズに参加できるようにすべきです。"
        ]},
        {"topic": "継続的改善", "templates": [
            "Keepの内容を標準化し、ベストプラクティスとして組織全体に展開すべきです。",
            "Problemの根本原因を深掘りする時間を設け、表面的な対処療法にならないようにしましょう。",
            "Tryの実行状況を定期的にフォローアップし、PDCAサイクルを回す仕組みを作りたいです。",
            "過去のKPTを振り返り、どれだけ改善が進んだかを定量的に測定する指標を導入しませんか。",
            "KPTの内容を評価制度に組み込み、改善活動を正当に評価する仕組みを提案します。",
            "Tryを実行するための時間を業務時間内に確保し、優先的に取り組める環境を作るべきです。",
            "Problemに対して「なぜ?」を5回繰り返し、真因を特定する手法を取り入れましょう。",
            "Keepを継続するための仕組み化を進め、属人化を防ぐ運用にしたいです。",
            "改善活動の成果を四半期ごとに振り返り、大きな変化を実感できる機会を作るべきです。",
            "Tryの実行責任者を明確にし、誰が何をいつまでにやるかを可視化しませんか。",
            "KPTで出た改善案を「すぐできること」と「時間がかかること」に分類して優先順位をつけましょう。",
            "改善活動の進捗を週次で共有し、チーム全体で状況を把握できるようにすべきです。",
            "Tryを実行した結果を次回のKPTで必ず報告し、効果測定を習慣化したいです。",
            "改善のアイデアを日常的に投稿できる「改善ボックス」をSlackに設置しませんか。",
            "Keepを他部署にも展開し、組織全体の生産性向上につなげるべきです。",
            "Problemを放置せず、必ず何らかのアクションを決める運用にしたいです。",
            "改善活動の成果を数値で可視化し、モチベーション向上につなげましょう。",
            "Tryの実行率が低い場合は、その原因を分析して改善する仕組みを作るべきです。",
            "KPTで出た改善案を「Quick Win」と「Long Term」に分けて管理しませんか。",
            "改善活動を楽しむ文化を醸成し、前向きに取り組める雰囲気を作りたいです。"
        ]},
        {"topic": "心理的安全性", "templates": [
            "KPTで率直な意見を言いやすくするため、匿名での投稿も選択できるようにすべきです。",
            "Problemに書いた内容が評価に影響しないことを明確にし、安心して課題を共有できる環境を作りましょう。",
            "KPTの場で出た意見を否定せず、まずは受け止める文化を醸成することが重要です。",
            "上司が一方的に話すのではなく、メンバー主導でKPTを進める運用に変更しませんか。",
            "KPTで出た課題について、経営層にも共有し、組織全体で改善に取り組む姿勢を示してほしいです。",
            "振り返りの場で失敗を責めるのではなく、学びとして捉える文化を作るべきです。",
            "KPTで発言しやすい雰囲気を作るため、アイスブレイクの時間を設けましょう。",
            "Problemを共有した人に感謝を伝え、課題を可視化する勇気を称える運用にしたいです。",
            "KPTの場で「批判」ではなく「建設的なフィードバック」を心がけるルールを作るべきです。",
            "振り返りの内容が外部に漏れないよう、守秘義務を徹底する運用にしませんか。",
            "KPTで沈黙が続く場合は、少人数のグループに分けて議論する方式を試したいです。",
            "新メンバーも安心して発言できるよう、KPTの目的と進め方を丁寧に説明すべきです。",
            "振り返りの場で「正解」を求めるのではなく、多様な意見を歓迎する姿勢を示しましょう。",
            "KPTで出た意見に対して「なぜそう思うのか?」を優しく聞く文化を作りたいです。",
            "Problemを共有することが「弱さ」ではなく「強さ」だと認識できる環境を整えるべきです。",
            "KPTの場で役職や経験年数に関係なく、フラットに意見を言える雰囲気を作りませんか。",
            "振り返りの内容をポジティブに捉え、改善のチャンスとして前向きに議論したいです。",
            "KPTで「こんなこと言っていいのかな?」と躊躇する雰囲気をなくすべきです。",
            "振り返りの場で出た意見を真摯に受け止め、必ずフィードバックする運用にしましょう。",
            "KPTを通じて信頼関係を深め、チームの結束力を高める機会にしたいです。"
        ]}
    ],
    "product": [
        {"topic": "ドキュメント整備", "templates": [
            "仕様書がない機能の実装は行わないというルールを徹底すべきです。",
            "要件定義書をGitで管理し、変更履歴を追えるようにすることを提案します。", 
            "最新の仕様へのリンクを常にSlackのチャンネルトピックに貼る運用にしましょう。",
            "ドキュメント専任担当者を配置し、品質を維持する体制を作るべきです。",
            "Figmaと実装の乖離を防ぐため、デザインシステムの導入を提案します。"
        ]},
        {"topic": "UX改善施策", "templates": [
            "ユーザーテストを開発初期段階で実施し、手戻りを防ぐフローを提案します。",
            "直感的なUIにするため、ヒートマップツールを導入して分析すべきです。", 
            "モバイルファーストでデザインを見直すプロジェクトを立ち上げたいです。",
            "デザインの統一性を保つため、UIコンポーネントライブラリを整備しましょう。",
            "ロード時間短縮のため、画像の最適化とCDNの活用を提案します。"
        ]},
        {"topic": "アクセシビリティ対応", "templates": [
            "スクリーンリーダーでの動作確認をQA項目に追加することを提案します。",
            "配色のコントラスト比をチェックするCIツールを導入すべきです。", 
            "WAI-ARIAに準拠したマークアップを徹底するガイドラインを策定しましょう。",
            "キーボード操作のみで完結できるようにUIを改修すべきです。",
            "全画像のalt属性入力を必須化するLintルールを追加しませんか。"
        ]},
        {"topic": "多言語対応", "templates": [
            "プロの翻訳家に依頼し、機械翻訳の不自然さを解消することを提案します。",
            "日時フォーマットをライブラリで自動変換する実装に統一すべきです。", 
            "i18n対応のライブラリを導入し、テキストのハードコードを禁止しましょう。",
            "多通貨決済に対応するための決済基盤の刷新を提案します。"
        ]},
        {"topic": "検索機能強化", "templates": [
            "Elasticsearchを導入し、検索精度と速度を向上させる提案です。",
            "表記ゆれに対応するため、辞書データの整備を行うべきです。", 
            "検索結果のフィルタリングUIを改善し、使い勝手を向上させましょう。",
            "AIを活用したサジェスト機能を実装し、UXを高める提案をします。"
        ]}
    ],
    "welfare": [
        {"topic": "CI/CD高速化", "templates": [
            "CIの並列実行数を増やし、待ち時間を半減させる投資を提案します。",
            "ビルドキャッシュを活用し、デプロイ時間を短縮する設定を入れましょう。", 
            "ボトルネックになっているテストを特定し、リファクタリングする時間をください。",
            "GitHub ActionsのSelf-hosted Runnerを導入し、コストと速度を改善すべきです。",
            "デプロイ完了通知をSlackだけでなくデスクトップ通知にも連携させたいです。"
        ]},
        {"topic": "ハードウェア刷新", "templates": [
            "全エンジニアのPCをメモリ32GB以上にアップグレードすることを提案します。",
            "生産性向上のため、希望者には昇降デスクを支給してはどうでしょうか。", 
            "古いPCのリプレイス基準を明確にし、定期的に更新する制度を作りましょう。",
            "M3 Macの導入ROIを算出したので、試験導入を許可してください。", 
            "モニターを2枚支給し、開発効率を上げる投資をお願いします。"
        ]},
        {"topic": "リモート環境改善", "templates": [
            "より安定したVPNサービスへの乗り換えを強く推奨します。", 
            "リモートワーク手当を増額し、自宅の通信環境整備に充てさせるべきです。",
            "フルリモート、ハイブリッドを選択できる柔軟な勤務体系を提案します。",
            "オフィスとリモートの格差をなくすため、全会議をオンライン前提にしましょう。"
        ]},
        {"topic": "スキルアップ支援", "templates": [
            "技術書購入やUdemy受講の費用を無制限で補助する制度を提案します。",
            "国内外のカンファレンス参加費と渡航費を会社が負担する仕組みを作りましょう。", 
            "業務時間の20%を学習や研究に使ってよい『20%ルール』を導入しませんか。",
            "資格取得報奨金制度を復活させ、学習意欲を刺激すべきです。",
            "社内勉強会のランチ補助を出し、コミュニケーションを活性化させましょう。"
        ]},
        {"topic": "健康経営", "templates": [
            "人間ドックの費用補助対象を若手社員にも拡大することを提案します。",
            "産業医との面談をオンラインで気軽に予約できるシステムを導入すべきです。", 
            "メンタルヘルスチェックを義務化し、早期発見できる体制を作りましょう。",
            "インフルエンザ予防接種の社内集団接種を実施してはどうでしょうか。"
        ]}
    ],
    "tech": [
        {"topic": "技術的負債返済", "templates": [
            "機能開発を止めてリファクタリングに集中する期間を設けることを提案します。",
            "テストコードがない箇所の改修は禁止するというルールを作りましょう。", 
            "技術的負債をバックログ化し、スプリントごとに消化する運用を提案します。",
            "複雑なクラスを分割し、責務を明確にする設計見直し時間をください。",
            "古いライブラリを一掃するための特別プロジェクトを立ち上げたいです。"
        ]},
        {"topic": "エラー撲滅", "templates": [
            "エラーログの監視ツール(Sentry等)を導入し、検知を自動化すべきです。",
            "独自のエラーコード体系を廃止し、標準的なHTTPステータスに準拠しましょう。", 
            "ログにトレーシングIDを付与し、リクエストを一気通貫で追えるようにする提案です。",
            "夜間のシステムアラートを削減するため、自動復旧の仕組みを導入しませんか。",
            "エラー通知の閾値を見直し、オオカミ少年状態を解消すべきです。"
        ]},
        {"topic": "セキュリティ強化", "templates": [
            "脆弱性スキャンをパイプラインに組み込み、リリースをブロックする運用にしましょう。",
            "パスワードレス認証(WebAuthn)を導入し、セキュリティと利便性を両立させたいです。", 
            "S3バケットの公開設定を自動チェックする仕組み(Config rules)を入れましょう。",
            "個人情報を含むデータへのアクセスログを常時監視する体制を提案します。",
            "退職者アカウントの削除フローを自動化し、人的ミスをなくすべきです。"
        ]},
        {"topic": "コスト削減", "templates": [
            "AWSのコスト分析を行い、無駄なリソースを削減するタスクフォースを希望します。",
            "開発環境の自動停止スクリプトを導入し、夜間休日コストをカットしましょう。", 
            "ログの保持期間ポリシー策定と、S3ライフサイクル設定の適用を提案します。",
            "リザーブドインスタンスやSavings Plansの購入検討をお願いします。",
            "CDNのキャッシュ設定を見直し、オリジンへの負荷と転送量を減らす提案です。"
        ]},
        {"topic": "ドキュメントツール活用", "templates": [
            "社内ドキュメントツールをNotionに統一し、情報の一元化を図るべきです。",
            "Wikiの定期的な棚卸しデーを設け、古い情報をアーカイブする運用にしましょう。", 
            "API仕様書はSwagger(OpenAPI)でコードから自動生成するフローにしませんか。",
            "議事録は自動文字起こしツールを導入し、作成工数をゼロにする提案です。"
        ]}
    ],
    "values": [
        {"topic": "称賛の仕組み", "templates": [
            "Slackに『#thanks』チャンネルを作り、ボットで集計して表彰する仕組みを提案します。",
            "ピアボーナスツールを導入し、感謝を少額のボーナスとして送り合う制度にしませんか。", 
            "週次MTGの冒頭で、今週のMVPを発表する時間を設けましょう。",
            "失敗した挑戦も称賛する『ナイスチャレンジ賞』の新設を提案します。",
            "他部署の貢献を見える化する社内報の発行を提案します。"
        ]},
        {"topic": "挑戦の奨励", "templates": [
            "業務時間の10%を新しい技術検証に使ってよいルールを導入すべきです。",
            "失敗しても評価が下がらないことを明文化した『チャレンジ評価制度』を提案します。", 
            "新規事業コンテストを開催し、ボトムアップでアイデアを募集しましょう。",
            "ハッカソンを定期開催し、イノベーションの種を撒く活動を推奨します。",
            "新しいツールの導入稟議を簡素化し、スピード感を持って試せる環境にしてください。"
        ]},
        {"topic": "心理的安全性向上", "templates": [
            "無記名で経営陣に質問できるQ&Aセッションの定期開催を提案します。",
            "『Yes, And』の精神で、反対意見もまずは受け止めるルールを会議に導入しましょう。",
            "若手社員がメンター以外にも相談できる斜めの関係作りを支援する制度が必要です。",
            "心理的安全性を測るサーベイを毎月実施し、改善サイクルを回すべきです。",
            "ミスをした人を責めるのではなく、システムの問題として捉える『ポストモーテム』を徹底しましょう。"
        ]},
        {"topic": "顧客志向の徹底", "templates": [
            "開発者も定期的にカスタマーサポート業務を体験し、顧客の声を直接聞く研修を提案します。",
            "ドッグフーディングを義務化し、自分たちが一番のヘビーユーザーになるべきです。", 
            "NPS（顧客推奨度）を全社員の共通KPIに設定することを提案します。",
            "顧客インタビューの動画をランチタイムに上映し、ユーザー像を共有しましょう。",
            "ペルソナシートをオフィスの目立つ場所に貼り出し、常に顧客を意識させたいです。"
        ]},
        {"topic": "スピード重視", "templates": [
            "承認プロセスを最大2段階までに減らし、意思決定スピードを上げる提案です。",
            "完璧を目指してリリースを遅らせるより、MVPで早く市場に出す方針に転換すべきです。", 
            "会議での持ち帰り検討を禁止し、その場で決断するルールを導入しませんか。",
            "アジャイル開発の講師を招き、本格的なスクラム導入を検討すべきです。",
            "稟議書を廃止し、Slackでのスタンプ承認で進められる範囲を広げましょう。"
        ]}
    ],
    "bukai": [
        {"topic": "情報共有の改善", "templates": [
            "部会の資料を事前に共有し、参加者が準備してから臨めるようにすべきです。",
            "部会の議事録を全社員に公開し、情報の透明性を高めることを提案します。",
            "部会で共有された情報を、各部署で確実に展開する仕組みを作りましょう。",
            "部会の内容を録画し、参加できなかったメンバーも後から視聴できるようにしませんか。",
            "部会で出た質問と回答をFAQとしてまとめ、社内Wikiに掲載する運用を提案します。",
            "部会の資料をテンプレート化し、読みやすく統一されたフォーマットにすべきです。",
            "部会の重要な決定事項をSlackで即座に全社通知する仕組みを作りましょう。",
            "部会の内容をダイジェスト版にまとめ、忙しい人も短時間で把握できるようにしませんか。",
            "部会で使用したスライドを社内ポータルに常時公開すべきです。",
            "部会の内容を部署ごとにカスタマイズして展開する運用を提案します。",
            "部会の録画に字幕を付け、アクセシビリティを向上させましょう。",
            "部会の内容を英語でも共有し、グローバルメンバーも理解できるようにすべきです。",
            "部会で共有された数字やグラフをダッシュボード化し、リアルタイムで確認できるようにしませんか。",
            "部会の資料をモバイルでも見やすい形式に最適化すべきです。",
            "部会の内容を新入社員向けにアーカイブ化し、オンボーディング資料として活用しましょう。",
            "部会で出た質問を事前に募集し、回答を準備してから臨む運用にしませんか。",
            "部会の議事録作成を自動化ツールで効率化すべきです。",
            "部会の内容をポッドキャスト形式で配信し、通勤時間に聞けるようにしたいです。",
            "部会で共有された資料のバージョン管理を徹底し、最新版を常に参照できるようにしましょう。",
            "部会の内容を社内ニュースレターでも配信し、情報の到達率を高めるべきです。"
        ]},
        {"topic": "運営方法の改善", "templates": [
            "部会の時間を短縮し、要点を絞った効率的な運営にすべきです。",
            "部会の頻度を見直し、必要に応じて臨時開催も柔軟に行える体制を作りましょう。",
            "部会のアジェンダを事前に募集し、現場の関心事も取り上げる運用にしませんか。",
            "部会をオンラインとオフラインのハイブリッド形式にし、参加しやすくすべきです。",
            "部会の最後に質疑応答の時間を十分に確保し、双方向のコミュニケーションを促進したいです。",
            "部会の進行役をローテーション制にし、多様な視点を取り入れるべきです。",
            "部会の開催時間を複数設定し、参加しやすい時間を選べるようにしませんか。",
            "部会の内容を事前アンケートで決定し、参加者のニーズに合わせた運営にしましょう。",
            "部会の冒頭でアイスブレイクを実施し、発言しやすい雰囲気を作るべきです。",
            "部会の満足度を毎回測定し、改善サイクルを回す運用を提案します。",
            "部会の参加を任意にし、関心のあるテーマだけ参加できるようにしませんか。",
            "部会の内容を小グループディスカッション形式にし、全員が発言できる機会を作りましょう。",
            "部会の資料を事前に読んでもらい、当日は質疑応答に集中する運用にすべきです。",
            "部会の開催通知を1週間前に送り、スケジュール調整しやすくしませんか。",
            "部会の内容を録画して、倍速再生で効率的に視聴できるようにしたいです。",
            "部会の進行をタイムキーパーで管理し、時間通りに終わる運営を徹底すべきです。",
            "部会の内容をワークショップ形式にし、参加型の学びの場にしましょう。",
            "部会の後にフォローアップミーティングを設け、理解を深める機会を作りませんか。",
            "部会の内容を部署別に分けて開催し、関連性の高い情報だけ共有すべきです。",
            "部会の運営ガイドラインを作成し、質の高い運営を標準化したいです。"
        ]},
        {"topic": "内容の充実", "templates": [
            "部会で他部署の成功事例を共有し、横展開できる仕組みを作るべきです。",
            "部会で技術トレンドや業界動向も取り上げ、視野を広げる機会にしましょう。",
            "部会で現場の課題をボトムアップで共有する時間を設けることを提案します。",
            "部会で新しい施策の背景や意図を丁寧に説明し、納得感を高める運用にしませんか。",
            "部会で社員の声を直接聞く機会を設け、経営層との距離を縮めるべきです。",
            "部会で外部講師を招き、専門的な知見を学ぶ機会を作りましょう。",
            "部会で競合他社の動向を分析し、戦略的な視点を養う時間を設けませんか。",
            "部会で失敗事例も共有し、学びの機会として活用すべきです。",
            "部会で新規事業のアイデアを募集し、イノベーションを促進したいです。",
            "部会で顧客の声を直接共有し、ユーザー視点を強化する運用を提案します。",
            "部会でデータドリブンな意思決定の事例を紹介し、分析力を高めましょう。",
            "部会でキャリアパスの事例を共有し、成長のロールモデルを示すべきです。",
            "部会で社会貢献活動の報告も行い、企業の社会的責任を意識する機会にしませんか。",
            "部会で技術的な深掘りセッションも設け、エンジニアの学びを支援したいです。",
            "部会でクロスファンクショナルなプロジェクト事例を共有し、協業を促進すべきです。",
            "部会で経営指標の読み方を学ぶ時間を設け、ビジネス理解を深めましょう。",
            "部会で新入社員の紹介も行い、組織の一体感を高める運用にしませんか。",
            "部会で社内ツールの活用Tips を共有し、生産性向上につなげるべきです。",
            "部会でダイバーシティ&インクルージョンの取り組みも報告し、意識を高めたいです。",
            "部会で四半期の振り返りと次期の目標を共有し、方向性を揃える機会にしましょう。"
        ]}
    ],
    "service_spirit": [
        {"topic": "サービス精神の定義", "templates": [
            "サービス精神の具体的な行動例を明文化し、全員で共通認識を持つべきです。",
            "サービス精神を行動指針やバリューに組み込み、組織文化として定着させましょう。",
            "サービス精神を顧客だけでなく、社内のメンバー同士の関わりにも適用することを提案します。",
            "サービス精神を発揮した具体的な事例を社内で共有し、ベストプラクティスとして可視化しませんか。",
            "サービス精神の重要性を新入社員研修で伝え、早期から文化として根付かせるべきです。",
            "サービス精神を測定する指標を設定し、定量的に評価できるようにしましょう。",
            "サービス精神を発揮する場面を具体的にリストアップし、行動に落とし込むべきです。",
            "サービス精神を体現している社員をロールモデルとして紹介しませんか。",
            "サービス精神を発揮するための研修プログラムを開発すべきです。",
            "サービス精神を組織のミッションやビジョンと紐づけ、意義を明確にしたいです。",
            "サービス精神を発揮した行動を社内報で紹介し、認知度を高めましょう。",
            "サービス精神を顧客満足度やNPSと関連付けて説明すべきです。",
            "サービス精神を発揮するためのチェックリストを作成しませんか。",
            "サービス精神を部署ごとに具体化し、それぞれの業務に合わせた定義を作るべきです。",
            "サービス精神を発揮する際の判断基準を明確にし、迷わず行動できるようにしたいです。",
            "サービス精神を経営層が率先して示し、トップダウンで浸透させましょう。",
            "サービス精神を発揮した結果を数値で可視化し、効果を実感できるようにすべきです。",
            "サービス精神を社外にも発信し、企業ブランドとして確立しませんか。",
            "サービス精神を発揮するための環境整備(時間、リソース)を行うべきです。",
            "サービス精神を継続的に学び、進化させる仕組みを作りたいです。"
        ]},
        {"topic": "評価と表彰", "templates": [
            "サービス精神を体現した行動を評価制度に組み込み、正当に評価する仕組みを作りましょう。",
            "サービス精神を発揮した人をMVPとして表彰する制度を新設することを提案します。",
            "ピアボーナス制度を導入し、サービス精神を発揮した人に感謝を伝え合う文化を作りませんか。",
            "サービス精神に関する社内アワードを設け、優れた事例を全社で共有すべきです。",
            "360度評価でサービス精神の項目を追加し、多面的に評価する仕組みを導入したいです。",
            "サービス精神を発揮した行動を昇進・昇格の基準に含めるべきです。",
            "サービス精神を発揮した人に特別休暇を付与する制度を作りましょう。",
            "サービス精神を発揮した事例を四半期ごとに表彰する運用にしませんか。",
            "サービス精神を発揮した人の名前を社内掲示板に掲載すべきです。",
            "サービス精神を発揮した行動をポイント化し、インセンティブと連動させたいです。",
            "サービス精神を発揮した人を社内イベントで紹介する機会を作りましょう。",
            "サービス精神を発揮した行動を評価する際の基準を明確にすべきです。",
            "サービス精神を発揮した人に感謝のメッセージを送る文化を醸成しませんか。",
            "サービス精神を発揮した行動を人事評価のコメント欄に必ず記載する運用にしたいです。",
            "サービス精神を発揮した人を部署を超えて称賛する仕組みを作るべきです。",
            "サービス精神を発揮した行動を定期的に振り返り、学びを共有しましょう。",
            "サービス精神を発揮した人に特別なバッジや称号を付与しませんか。",
            "サービス精神を発揮した行動を社内SNSでシェアし、認知度を高めるべきです。",
            "サービス精神を発揮した人を経営層が直接表彰する機会を設けたいです。",
            "サービス精神を発揮した行動を年次報告書にも掲載し、社外にもアピールしましょう。"
        ]},
        {"topic": "実践と浸透", "templates": [
            "リーダー層が率先してサービス精神を実践し、ロールモデルとなるべきです。",
            "サービス精神に関するワークショップや勉強会を定期的に開催することを提案します。",
            "顧客の声を社内で共有し、サービス精神の重要性を実感できるようにしましょう。",
            "Thanksカードを導入し、感謝を伝え合う習慣を定着させませんか。",
            "サービス精神を測定する指標(顧客満足度、NPSなど)を設定し、成果を可視化すべきです。",
            "サービス精神を発揮する機会を日常業務の中に組み込むべきです。",
            "サービス精神を発揮した行動を朝会で共有する運用にしましょう。",
            "サービス精神を発揮するためのツールやリソースを提供しませんか。",
            "サービス精神を発揮した行動を社内ニュースレターで紹介すべきです。",
            "サービス精神を発揮するための時間を業務時間内に確保したいです。",
            "サービス精神を発揮した行動を部署ごとに振り返る機会を作りましょう。",
            "サービス精神を発揮するためのマニュアルやガイドラインを整備すべきです。",
            "サービス精神を発揮した行動を新人教育の教材として活用しませんか。",
            "サービス精神を発揮するための予算を確保し、自由に使えるようにしたいです。",
            "サービス精神を発揮した行動を社内コンテストで競い合う機会を作るべきです。",
            "サービス精神を発揮するための相談窓口を設置しましょう。",
            "サービス精神を発揮した行動を定期的にレビューし、改善点を見つけませんか。",
            "サービス精神を発揮するための社内コミュニティを立ち上げるべきです。",
            "サービス精神を発揮した行動を外部にも発信し、採用ブランディングに活用したいです。",
            "サービス精神を発揮するための環境づくりを全社で推進しましょう。"
        ]}
    ],
    "organization": [
        {"topic": "組織構造の改善", "templates": [
            "部署間の連携を強化するため、横断的なプロジェクトチームを定期的に編成すべきです。",
            "意思決定のプロセスを明確化し、スピード感を持って判断できる体制を作りましょう。",
            "リソース配分を定期的に見直し、負荷が偏らないよう調整する仕組みを提案します。",
            "情報の透明性を高めるため、経営会議の議事録も公開することを検討しませんか。",
            "組織の目標と個人の目標を紐づけ、方向性を明確にする仕組みを導入すべきです。",
            "組織図を定期的に見直し、変化に柔軟に対応できる体制を作りましょう。",
            "部署の壁を越えたコミュニケーションを促進するイベントを開催すべきです。",
            "組織のミッションやビジョンを全員で再確認する機会を設けませんか。",
            "組織の意思決定に現場の声を反映させる仕組みを作りたいです。",
            "組織の課題を可視化し、優先順位をつけて解決する運用にしましょう。",
            "組織の成功事例を共有し、ベストプラクティスを横展開すべきです。",
            "組織の健康度を測定するサーベイを定期的に実施しませんか。",
            "組織の変革を推進するチェンジエージェントを育成すべきです。",
            "組織の文化を明文化し、採用や評価の基準として活用したいです。",
            "組織の課題解決にデザイン思考を取り入れる研修を実施しましょう。",
            "組織の情報共有を効率化するツールを導入すべきです。",
            "組織の意思決定にデータを活用し、客観性を高めませんか。",
            "組織の柔軟性を高めるため、リモートワークやフレックスタイムを拡充したいです。",
            "組織の多様性を高めるため、採用基準を見直すべきです。",
            "組織の持続可能性を高めるため、長期的な視点で戦略を立てましょう。"
        ]},
        {"topic": "評価制度の改善", "templates": [
            "評価基準を明文化し、何を頑張れば評価されるのかを明確にすべきです。",
            "評価のフィードバックを丁寧に行い、成長の糧にできる運用にしましょう。",
            "評価者研修を実施し、評価の質を均一化することを提案します。",
            "成果だけでなくプロセスも評価する仕組みを導入しませんか。",
            "評価制度の満足度を定期的に測定し、改善サイクルを回すべきです。",
            "評価の透明性を高めるため、評価結果の理由を詳しく説明する運用にしたいです。",
            "評価を相対評価から絶対評価に変更し、公平性を高めましょう。",
            "評価の頻度を増やし、タイムリーなフィードバックを提供すべきです。",
            "評価に360度フィードバックを導入し、多面的な視点を取り入れませんか。",
            "評価の際に自己評価も重視し、本人の意見を尊重する運用にしたいです。",
            "評価基準を定期的に見直し、時代に合わせて更新しましょう。",
            "評価の結果を昇給や昇進に明確に連動させるべきです。",
            "評価の際に具体的な行動例を示し、理解しやすくしませんか。",
            "評価のバイアスを減らすため、複数の評価者で判断する仕組みを作りたいです。",
            "評価の結果を本人だけでなくチーム全体で共有し、学びの機会にすべきです。",
            "評価の際に将来のキャリアパスも一緒に議論する運用にしましょう。",
            "評価の基準を部署ごとにカスタマイズし、業務特性を反映させませんか。",
            "評価の際に強みと弱みを明確にし、成長の方向性を示すべきです。",
            "評価の結果を研修計画に反映させ、スキルアップを支援したいです。",
            "評価の公平性を担保するため、第三者機関のレビューを受けることを検討しましょう。"
        ]},
        {"topic": "開発体制の最適化", "templates": [
            "チームの役割分担を見直し、柔軟に対応できる体制を作るべきです。",
            "コードレビューのプロセスを改善し、レビュー待ち時間を短縮しましょう。",
            "品質管理の仕組みを強化し、自動テストの比率を高めることを提案します。",
            "技術的負債の返済時間を確保し、計画的に解消する運用にしませんか。",
            "新メンバーのオンボーディングプロセスを改善し、早期に戦力化できる仕組みを作るべきです。",
            "開発環境を統一し、セットアップの手間を削減したいです。",
            "開発のベストプラクティスを文書化し、全員で共有しましょう。",
            "開発の生産性を測定する指標を導入し、改善の効果を可視化すべきです。",
            "開発チームの規模を最適化し、コミュニケーションコストを削減しませんか。",
            "開発のボトルネックを特定し、優先的に解消する運用にしたいです。",
            "開発のドキュメントを充実させ、属人化を防ぐべきです。",
            "開発のツールチェーンを見直し、最新の技術を取り入れましょう。",
            "開発の進捗を可視化し、問題を早期に発見する仕組みを作りませんか。",
            "開発のペアプログラミングやモブプログラミングを導入し、知識共有を促進すべきです。",
            "開発のスキルマップを作成し、育成計画を立てたいです。",
            "開発のセキュリティ対策を強化し、脆弱性を減らしましょう。",
            "開発のパフォーマンスを定期的に測定し、最適化すべきです。",
            "開発のCI/CDパイプラインを改善し、デプロイの頻度を上げませんか。",
            "開発のテストカバレッジを向上させ、品質を担保したいです。",
            "開発の技術スタックを定期的に見直し、最適な選択を続けるべきです。"
        ]}
    ],
    "oneonone_unit": [
        {"topic": "1on1の質向上", "templates": [
            "1on1の時間を延長し、じっくり対話できる環境を作るべきです。",
            "1on1のアジェンダを事前に共有し、準備してから臨める運用にしましょう。",
            "1on1を評価と完全に切り離し、成長支援の場であることを明確にすることを提案します。",
            "1on1で話した内容を記録し、次回に振り返れる仕組みを作りませんか。",
            "1on1のガイドラインを作成し、質を均一化すべきです。",
            "1on1で本音を話しやすくするため、リラックスできる環境を整えたいです。",
            "1on1でキャリアの相談も積極的に行い、成長を支援しましょう。",
            "1on1で業務以外の話題も取り上げ、信頼関係を深めるべきです。",
            "1on1でフィードバックを双方向で行い、上司も成長できる機会にしませんか。",
            "1on1で目標設定を一緒に行い、モチベーションを高めたいです。",
            "1on1で悩みや不安を共有し、早期に解決する運用にしましょう。",
            "1on1でストレングスファインダーなどのツールを活用し、強みを伸ばすべきです。",
            "1on1で過去の振り返りも行い、成長を実感できる機会にしませんか。",
            "1on1で他部署との連携についても話し合い、視野を広げたいです。",
            "1on1でワークライフバランスについても確認し、健康をサポートしましょう。",
            "1on1で新しい挑戦を後押しし、成長機会を提供すべきです。",
            "1on1で感謝の気持ちを伝え合い、ポジティブな関係を築きませんか。",
            "1on1で将来のキャリアビジョンを描き、実現に向けた計画を立てたいです。",
            "1on1で学びたいスキルを共有し、研修機会を提供しましょう。",
            "1on1で組織の課題についても意見交換し、改善につなげるべきです。"
        ]},
        {"topic": "1on1の運用改善", "templates": [
            "1on1の頻度を増やし、タイムリーに相談できる環境を作るべきです。",
            "1on1の満足度を定期的に測定し、改善サイクルを回しましょう。",
            "上長以外のメンターやコーチとも話せる選択肢を提供することを提案します。",
            "1on1をオンラインとオフラインで選べるようにし、話しやすい環境を提供しませんか。",
            "1on1で業務の進捗確認は別の場で行い、対話に集中できる時間にすべきです。",
            "1on1の日程を柔軟に調整できるようにし、参加しやすくしたいです。",
            "1on1の内容を本人が主導で決められるようにしましょう。",
            "1on1の時間を確保するため、他の会議を調整する優先度を上げるべきです。",
            "1on1のキャンセルを極力避け、定期的に実施する文化を作りませんか。",
            "1on1の効果を測定し、ROIを可視化したいです。",
            "1on1の内容を人事にも共有し(本人の同意のもと)、組織改善に活用しましょう。",
            "1on1の研修を上司向けに実施し、スキルを向上させるべきです。",
            "1on1の場所を工夫し、オフィス外でもリラックスして話せる環境を提供しませんか。",
            "1on1の時間を業務時間として正式に認め、優先度を高めたいです。",
            "1on1の内容をテンプレート化し、話すべきトピックを明確にしましょう。",
            "1on1の後にアクションアイテムを設定し、フォローアップする運用にすべきです。",
            "1on1の内容を匿名でフィードバックできる仕組みを作りませんか。",
            "1on1の効果的な進め方を社内で共有し、ベストプラクティスを広めたいです。",
            "1on1の時間を新人には長めに設定し、手厚くサポートしましょう。",
            "1on1の運用ルールを明文化し、全員で共通認識を持つべきです。"
        ]},
        {"topic": "ユニット活動の活性化", "templates": [
            "ユニット活動の目的を明確にし、参加者全員で共有すべきです。",
            "ユニット活動の成果を評価し、組織への貢献を可視化しましょう。",
            "ユニット活動で得た知見を組織に還元する仕組みを作ることを提案します。",
            "ユニット活動を楽しみながら学べる、活気のある場にするための工夫をしませんか。",
            "ユニット活動の参加を任意にし、自発的に参加したい人が集まる運用にすべきです。",
            "ユニット活動の時間を業務時間内に確保し、参加しやすくしたいです。",
            "ユニット活動の成果を社内で発表する機会を設けましょう。",
            "ユニット活動のテーマを参加者が決められるようにし、主体性を高めるべきです。",
            "ユニット活動の予算を確保し、必要なリソースを提供しませんか。",
            "ユニット活動の参加者同士の交流を促進するイベントを開催したいです。",
            "ユニット活動の成果を評価制度に反映させ、モチベーションを高めましょう。",
            "ユニット活動のリーダーを育成し、運営の質を向上させるべきです。",
            "ユニット活動の内容を社内報で紹介し、認知度を上げませんか。",
            "ユニット活動で外部の専門家を招き、学びの機会を提供したいです。",
            "ユニット活動の成果を製品やサービスに反映させる仕組みを作りましょう。",
            "ユニット活動の参加者にインセンティブを提供し、参加を促進すべきです。",
            "ユニット活動の満足度を測定し、改善サイクルを回しませんか。",
            "ユニット活動のベストプラクティスを共有し、他のユニットにも展開したいです。",
            "ユニット活動の成果を外部にも発信し、企業ブランディングに活用しましょう。",
            "ユニット活動を通じて部署を超えたネットワークを構築し、組織の活性化につなげるべきです。"
        ]}
    ]
}

def get_small_voice_comment(category="project"):
    """Returns a specific outlier comment."""
    cat = category if category in SMALL_VOICES else "project"
    return random.choice(SMALL_VOICES[cat])

def get_dense_cluster_comment(category="project"):
    """Returns a comment from a specific topic cluster with variations."""
    cat = category if category in DENSE_CLUSTERS else "project"
    cluster = random.choice(DENSE_CLUSTERS[cat])
    base_template = random.choice(cluster["templates"])
    
    # Add variations to make comments more unique
    prefixes = [
        "", "", "", "", "",  # 50% no prefix
        "個人的には、", "チームとして、", "長期的には、", "現状を踏まえると、",
        "他社の事例を見ても、", "実務的には、", "コスト面を考えると、",
        "ユーザー視点で考えると、", "セキュリティ面でも、", "将来を見据えて、"
    ]
    
    suffixes = [
        "", "", "", "", "",  # 50% no suffix
        " ぜひご検討ください。", " 早急な対応をお願いします。", 
        " 段階的に進めるのが良いと思います。", " まずは試験的に導入してみませんか。",
        " 他部署とも連携して進めたいです。", " 費用対効果は高いはずです。",
        " 現場の負担も軽減できます。", " 長期的にはメリットが大きいです。"
    ]
    
    prefix = random.choice(prefixes)
    suffix = random.choice(suffixes)
    
    return f"{prefix}{base_template}{suffix}"

def generate_sentence(parts):
    return "".join([random.choice(p) for p in parts if p])

def get_comment_generator(category):
    if category == 'project':
        return lambda: generate_sentence([INTROS, PROJ_SUBJECTS, PROJ_SOLUTIONS, PROJ_EFFECTS, CLOSINGS])
    elif category == 'welfare' or category == 'dev_env':
        return lambda: generate_sentence([INTROS, DEV_SUBJECTS, DEV_SOLUTIONS, DEV_EFFECTS, CLOSINGS])
    elif category == 'tech' or category == 'tech_quality':
        return lambda: generate_sentence([INTROS, TECH_SUBJECTS, TECH_SOLUTIONS, TECH_EFFECTS, CLOSINGS])
    elif category == 'values':
         # Since VALUES_THEMES etc are simplified in generate_test_data, 
         # I will just use the Dense Cluster templates here which are high quality proposals,
         # or use a simplified generator if needed.
         # For simplicity and quality, I'll use the dense cluster randomizer for 'values' general generation
         # or bring back the Q3 style.
         # Actually generate_test_data.py uses get_value_comment_q3.
         
         # To simplify this mock generator which doesn't need perfect parity,
         # I'll just use the topic clusters as they are rich now.
         return lambda: get_dense_cluster_comment('values')
    # New Forms - use dense cluster comments with variations
    elif category in ['kpt', 'bukai', 'service_spirit', 'organization', 'oneonone_unit']:
        return lambda: get_dense_cluster_comment(category)
    else:
        # Default analysis
        return lambda: generate_sentence([INTROS, PROJ_SUBJECTS, PROJ_SOLUTIONS, PROJ_EFFECTS, CLOSINGS])

def get_value_comment_q3():
    return get_dense_cluster_comment('values')

def generate_mock_analysis_data(theme: str, num_points: int = 50):
    """
    Generates mock analysis results and a mock report.
    Returns: (results_list, report_json_string)
    """
    
    # Detemine category from theme
    category = "project"
    if any(w in theme for w in ["製品", "product", "プロダクト"]): category = "product"
    elif any(w in theme for w in ["福利厚生", "welfare", "dev_env", "開発環境"]): category = "welfare"
    elif any(w in theme for w in ["技術", "tech", "quality", "tech_quality"]): category = "tech"
    elif any(w in theme for w in ["価値観", "value", "culture"]): category = "values"
    
    # 1. Generate Results (Points)
    results = []
    
    # Clusters in 2D space (Mock coordinates)
    # Define some centers for clusters
    centers = [
        (5.0, 5.0), (-5.0, 5.0), (5.0, -5.0), (-5.0, -5.0), (0.0, 8.0)
    ]
    
    dense_data = DENSE_CLUSTERS.get(category, DENSE_CLUSTERS["project"])
    small_voices = SMALL_VOICES.get(category, SMALL_VOICES["project"])
    
    # Generators
    gen_func = get_comment_generator(category)

    # Create Cluster Points
    used_topics = []
    if dense_data:
        for i, cluster_def in enumerate(dense_data):
            center = centers[i % len(centers)]
            topic = cluster_def["topic"]
            used_topics.append(topic)
            templates = cluster_def["templates"]
            
            # Generate 10-15 points per cluster
            n_cluster_points = random.randint(8, 12)
            for _ in range(n_cluster_points):
                # Jitter
                x = center[0] + random.gauss(0, 1.0)
                y = center[1] + random.gauss(0, 1.0)
                
                text = random.choice(templates)
                results.append({
                    "original_text": text,
                    "sub_topic": topic,
                    # sentiment removed
                    "summary": text[:30] + "...",
                    "x_coordinate": x,
                    "y_coordinate": y,
                    "cluster_id": i
                })

    # Create Outliers (Small Voices)
    for sv_text in small_voices:
        # Place far away
        x = random.choice([12.0, -12.0]) + random.gauss(0, 1.0)
        y = random.choice([12.0, -12.0]) + random.gauss(0, 1.0)
        
        results.append({
            "original_text": sv_text,
            "sub_topic": "個別意見",
            # sentiment removed
            "summary": sv_text[:30] + "...",
            "x_coordinate": x,
            "y_coordinate": y,
            "cluster_id": -1 # Noise
        })
        
    # Create Noise (Random Generated)
    remaining = max(0, num_points - len(results))
    for _ in range(remaining):
        x = random.uniform(-10, 10)
        y = random.uniform(-10, 10)
        text = gen_func()
        
        results.append({
            "original_text": text,
            "sub_topic": "その他",
            # sentiment removed
            "summary": text[:30] + "...",
            "x_coordinate": x,
            "y_coordinate": y,
            "cluster_id": 99 # Misc cluster
        })
        
    # 2. Generate Report (IssueDefinition)
    # Create a mock report based on the used clusters
    report_issues = []
    
    urgencies = ["high", "medium", "medium", "low"]
    
    for i, topic in enumerate(used_topics):
        report_issues.append({
            "title": topic,
            "description": f"「{topic}」に関する具体的な提案が多数（{random.randint(5, 15)}件）寄せられています。実現可能性の高い解決策が含まれています。",
            "urgency": urgencies[i % len(urgencies)],
            "category": "Organizational" if "制度" in topic or "会議" in topic or "文化" in topic or "称賛" in topic or "心理" in topic or "挑戦" in topic or "顧客" in topic or "スピード" in topic else "Technical"
        })
        
    # Add one small voice issue
    report_issues.append({
        "title": "【要注意】深刻な懸念（Small Voice）",
        "description": "少数ですが、コンプライアンスやハラスメントに関わる深刻な指摘が存在します。早急な事実確認が推奨されます。",
        "urgency": "high",
        "category": "organizational"
    })

    return results, json.dumps(report_issues, ensure_ascii=False)
